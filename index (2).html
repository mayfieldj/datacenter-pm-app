<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Center Project Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .accordion-content { display: none; }
        .accordion-content.active { display: block; }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <div class="container mx-auto p-4 max-w-4xl">
        <h1 class="text-3xl font-bold text-center mb-6">Data Center Project Management Tool</h1>
        
        <!-- Navigation Tabs -->
        <div class="flex border-b mb-4">
            <button id="tasksTab" class="flex-1 py-2 px-4 bg-blue-500 text-white font-semibold hover:bg-blue-600 focus:outline-none">Main Tasks</button>
            <button id="historyTab" class="flex-1 py-2 px-4 bg-gray-300 text-gray-800 font-semibold hover:bg-gray-400 focus:outline-none">Project History</button>
        </div>

        <!-- Main Tasks Section -->
        <div id="tasksSection" class="space-y-4">
            <p class="text-gray-600">Click a category to expand and add sub-tasks. Tasks are saved automatically.</p>
            <!-- Categories will be dynamically inserted here -->
        </div>

        <!-- Project History Section -->
        <div id="historySection" class="hidden space-y-4">
            <p class="text-gray-600">All tasks added, listed chronologically with timestamps.</p>
            <ul id="historyList" class="list-disc pl-5 space-y-2"></ul>
        </div>
    </div>

    <script>
        // Predefined categories
        const categories = [
            "Project Planning and Documentation",
            "Budgeting and Financial Management",
            "Procurement and Subcontractor Management",
            "Design and Engineering Coordination",
            "Permitting, Regulatory, and Compliance Management",
            "Risk Management and Quality Assurance",
            "Safety and Health Management",
            "Team and Stakeholder Management",
            "Scheduling and Logistics Preparation",
            "Reporting and Performance Monitoring",
            "Technology and Innovation Integration",
            "Sustainability and Community Engagement"
        ];

        // Load tasks and history from localStorage or initialize
        let tasks = JSON.parse(localStorage.getItem('tasks')) || categories.reduce((acc, cat) => ({ ...acc, [cat]: [] }), {});
        let history = JSON.parse(localStorage.getItem('history')) || [];

        // Function to save data to localStorage
        function saveData() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
            localStorage.setItem('history', JSON.stringify(history));
        }

        // Function to add a task
        function addTask(category, subtask) {
            if (subtask.trim()) {
                tasks[category].push(subtask);
                const timestamp = new Date().toLocaleString('en-US', { year: 'numeric', month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' });
                history.push(`${timestamp} - ${category}: ${subtask}`);
                saveData();
                renderTasks();
                renderHistory();
            }
        }

        // Function to render tasks
        function renderTasks() {
            const tasksSection = document.getElementById('tasksSection');
            tasksSection.innerHTML = '<p class="text-gray-600">Click a category to expand and add sub-tasks. Tasks are saved automatically.</p>';
            categories.forEach(category => {
                const div = document.createElement('div');
                div.className = 'border rounded-lg bg-white shadow';
                div.innerHTML = `
                    <button class="w-full text-left p-4 font-semibold text-lg bg-gray-50 hover:bg-gray-100">${category}</button>
                    <div class="accordion-content p-4">
                        <ul class="list-disc pl-5 space-y-1 mb-4">
                            ${tasks[category].length ? tasks[category].map((task, idx) => `<li>${idx + 1}. ${task}</li>`).join('') : '<li>No sub-tasks added yet.</li>'}
                        </ul>
                        <div class="flex space-x-2">
                            <input type="text" placeholder="Add a sub-task" class="flex-1 p-2 border rounded" id="${category.replace(/\s+/g, '')}_input">
                            <button class="p-2 bg-blue-500 text-white rounded hover:bg-blue-600" onclick="addTask('${category}', document.getElementById('${category.replace(/\s+/g, '')}_input').value)">Add</button>
                        </div>
                    </div>
                `;
                tasksSection.appendChild(div);
            });

            // Add accordion functionality
            document.querySelectorAll('.border button').forEach(btn => {
                btn.addEventListener('click', () => {
                    const content = btn.nextElementSibling;
                    const isActive = content.classList.contains('active');
                    document.querySelectorAll('.accordion-content').forEach(c => c.classList.remove('active'));
                    if (!isActive) content.classList.add('active');
                });
            });
        }

        // Function to render history
        function renderHistory() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = history.length ? history.map(entry => `<li>${entry}</li>`).join('') : '<li>No history yet. Add tasks on the Main Tasks tab.</li>';
        }

        // Tab navigation
        document.getElementById('tasksTab').addEventListener('click', () => {
            document.getElementById('tasksSection').classList.remove('hidden');
            document.getElementById('historySection').classList.add('hidden');
            document.getElementById('tasksTab').classList.add('bg-blue-500', 'text-white');
            document.getElementById('historyTab').classList.remove('bg-blue-500', 'text-white');
            document.getElementById('historyTab').classList.add('bg-gray-300', 'text-gray-800');
        });

        document.getElementById('historyTab').addEventListener('click', () => {
            document.getElementById('historySection').classList.remove('hidden');
            document.getElementById('tasksSection').classList.add('hidden');
            document.getElementById('historyTab').classList.add('bg-blue-500', 'text-white');
            document.getElementById('tasksTab').classList.remove('bg-blue-500', 'text-white');
            document.getElementById('tasksTab').classList.add('bg-gray-300', 'text-gray-800');
        });

        // Initial render
        renderTasks();
        renderHistory();
    </script>
</body>
</html>